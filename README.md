# Simutrans-Easy-Add-on
Simutransのアドオン製作を少しでも簡単にするツール2種類です。現在絶賛開発中のため細かい不具合や不便やバグがありますが、使いこなせればそれなりに便利だと思います。

(よく考えたらSimutransに限らず使えるな……？)

## 内容物
- image merger
- dat creator

## 動作確認環境
Windows 10 (64bit)

## インストール
distフォルダ内にWindows向け実行ファイルがあります。適当なところに保存してください。アンインストール時はこれらのファイルを削除してください。

拡張子.imgpをmerge_image.exeに、.datpをcreate_dat.exeに、それぞれ関連付けると、サンプルデータの実行に便利です。

## サンプルデータ
sampleフォルダ内にサンプルがあります。sampleフォルダ内のcolor.imgpファイルをimagemerger(merge_image.exe)で、color.datpファイルをdat creator(create_dat.exe)で、それぞれ開いてください。imgpやdatpと同じフォルダ内に、datやpngが生成されているはずです。

## image merger
プロジェクトファイルの記述に基づいて画像を統合します。一つのベース画像をもとに細かいバリエーション違いの画像を複数種類作りたいときなどに便利です。
### プロジェクトファイルの文法
#### 記入例
プロジェクトファイルは以下のように記述されています。
~~~
+[image_a,image_b,image_c]=>addon
~~~
#### レイヤ合成モード
最初の`+`は**通常合成モード**を意味します。`*`に変更すると**乗算合成モード**になります。このモードはPhotoshopなどのレイヤ合成モードと同様の挙動となります。個別のモードの挙動についてはここでは解説しませんので、分からない方はPhotoshopなどの解説サイトをご覧ください。

#### 素材ファイル名
`[]`の中身は、素材となるpngファイル名を相対パスで指定します。上記の例だと、「image_a.png」「image_b.png」「image_c.png」の3枚を順番に重ねていきます。

画像は、記述した順に上に重ねられます。上記の例では「image_a.png」が「image_b.png」や「image_c.png」の下に敷かれます。したがって、「image_b.png」「image_c.png」に透明部分がない場合、「image_a.png」は完全に隠れてしまいます。

#### 生成するファイル名
`=>`以降は、生成する画像名を指定します。上記の例では、「image_a.png」「image_b.png」「image_c.png」の3枚を重ねた画像を「addon.png」に保存します。

#### その他
以上が1セットになります。改行してから同様の文法でさらに記載することで、複数セットを一度に実行することができます。

このほか、サンプルデータには応用例などもありますので、そちらも参照してください。

## dat creator
プロジェクトファイルの記述に基づいてdatを記述します。色違いのように、基本的なスペックは同じで細かいバリエーションの違うdatを一括で作りたいときなどに便利です。
### プロジェクトファイルの文法
#### 記入例
プロジェクトファイルは以下のように記述されています。
~~~
base.dat=>addon.dat
[blue,Passaigere]
[red,Post]
~~~
#### 1行目:datファイル名
1行目には、`ベースにするファイル名=>生成するファイル名`の形で、datファイル名を相対パスで指定します。

上記の例では、「base.dat」について2行目以下の処理を行ったものを「addon.dat」に保存します。

#### 2行目:検索パターン
2行目には、バリエーション違いを作りたい部分を`[]`の中にカンマ区切りで記述します。

上記の例では、「base.dat」の中身の「blue」と「passaigere」の部分のバリエーション違いを作成します。

#### 3行目以降:置換パターン
3行目以降には、2行目に書いた部分をどのように置き換えるかを`[]`の中にカンマ区切りで記述します。

上記の例ではそれぞれ、2行目には`[blue,Passaigere]`と、3行目には`[red,Post]`と書いていますから、base.datの「blue」を「red」に、「Passaigere」を「Post」に置き換えたバリエーション違いを生成します。

改行することで複数指定可能です。

#### その他
サンプルデータも参照してください。

## 使用条件
特にありません。もっといいものを作れると思うので、作ったらぜひ公開してください。

## 謝辞
サンプルデータに、[くるり様の128箱積み素体](https://wikiwiki.jp/twitrans/addon/recycle)を使用させていただきました。感謝申し上げます。
